<nav class="bg-white shadow-sm border-b border-slate-200 py-4 px-6 flex justify-between items-center">
    <div class="flex items-center gap-2 font-bold text-xl text-slate-800">
        <a routerLink=""><i class="fa-solid fa-layer-group text-blue-600"></i></a> Solopreneur <span class="text-blue-600">Ultra</span>
    </div>
    <div class="text-sm font-medium text-slate-500">
        Total Estimado: <span id="headerPrice" class="text-blue-600 font-bold">${{ totalDisplay() | number: '1.0-0' }}</span>
    </div>
</nav>

<main class="flex-grow flex items-center justify-center p-4">
    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-100">
        
        <div class="bg-slate-100 p-4 border-b border-slate-200">
            <div class="flex justify-between mb-2 text-xs font-semibold text-slate-500 uppercase tracking-wide">
                <span [class.text-blue-600]="currentStep === 1">1. Industria</span>
                <span [class.text-blue-600]="currentStep === 2">2. Módulos</span>
                <span [class.text-blue-600]="currentStep === 3">3. Datos</span>
                <span [class.text-blue-600]="currentStep === 4">4. Resumen</span>
            </div>
            <div class="w-full bg-slate-300 rounded-full h-2">
                <div id="progressBar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" 
                     [style.width.%]="currentStep * 25"></div>
            </div>
        </div>

        <div class="p-8">
            <ng-container [ngSwitch]="currentStep">
                
                <div *ngSwitchCase="1" class="step-content active">
                    <h2 class="text-2xl font-bold mb-2 text-slate-800">Elige tu punto de partida</h2>
                    <p class="text-slate-500 mb-6">Selecciona la plantilla base según tu tipo de negocio.</p>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                        <div (click)="onIndustrySelect('Clinica Dental', 1000, $event)" 
                             [class.selected-card]="configService.industry() === 'Clinica Dental'"
                             class="industry-card cursor-pointer border-2 border-slate-200 rounded-xl p-6 hover:border-blue-400 transition-all text-center group">
                            <i class="fa-solid fa-tooth text-2xl text-blue-600 mb-2"></i>
                            <h3 class="font-bold text-slate-700">Dental</h3>
                            <p class="text-xs text-slate-400 mt-1">Desde $1,000</p>
                        </div>
                        <div (click)="onIndustrySelect('E-commerce', 1200, $event)" 
                             [class.selected-card]="configService.industry() === 'E-commerce'"
                             class="industry-card cursor-pointer border-2 border-slate-200 rounded-xl p-6 hover:border-blue-400 transition-all text-center group">
                            <i class="fa-solid fa-store text-green-600 text-xl mb-2"></i>
                            <h3 class="font-bold text-slate-700">Tienda Online</h3>
                            <p class="text-xs text-slate-400 mt-1">Desde $1,200</p>
                        </div>
                        <div (click)="onIndustrySelect('Consultora', 1500, $event)" 
                             [class.selected-card]="configService.industry() === 'Consultora'"
                             class="industry-card cursor-pointer border-2 border-slate-200 rounded-xl p-6 hover:border-blue-400 transition-all text-center group">
                            <i class="fa-solid fa-briefcase text-purple-600 text-xl mb-2"></i>
                            <h3 class="font-bold text-slate-700">Consultora</h3>
                            <p class="text-xs text-slate-400 mt-1">Desde $1,500</p>
                        </div>
                    </div>
                </div>

                <div *ngSwitchCase="2" class="step-content active">
                    <h2 class="text-2xl font-bold mb-2 text-slate-800">Personaliza tu Solución</h2>
                    <p class="text-slate-500 mb-6">Agrega superpoderes a tu sistema base.</p>

                    <div class="space-y-3">
                        <label *ngFor="let module of availableModules"
                            class="flex items-center justify-between p-4 border-2 border-slate-100 rounded-xl hover:bg-slate-50 cursor-pointer transition-colors has-[:checked]:border-blue-500 has-[:checked]:bg-blue-50">
                            <div class="flex items-center gap-4">
                                <input type="checkbox" (change)="onModuleToggle(module, $event)"
                                    class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 module-check">
                                <div>
                                    <div class="font-bold text-slate-700">{{ module.name }}</div>
                                    <div class="text-xs text-slate-500">
                                        {{ module.description }}
                                    </div>
                                </div>
                            </div>
                            <span class="font-semibold text-slate-600 text-sm">+$ {{ module.price | number }}</span>
                        </label>
                    </div>
                </div>

                <div *ngSwitchCase="3" class="step-content active">
                    <h2 class="text-2xl font-bold mb-2 text-slate-800">Crea tu Cuenta</h2>
                    <p class="text-slate-500 mb-6">Necesitamos estos datos para generar tu contrato.</p>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Nombre Completo</label>
                            <input [(ngModel)]="client.name" type="text" placeholder="Ej. Juan Pérez" required
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Correo Electrónico</label>
                            <input [(ngModel)]="client.email" type="email" placeholder="juan@empresa.com" required
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Empresa</label>
                            <input [(ngModel)]="client.company" type="text" placeholder="Nombre de tu negocio"
                                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all">
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg flex gap-3 items-start mt-4">
                            <input [(ngModel)]="client.termsChecked" type="checkbox" required
                                class="mt-1 w-4 h-4 text-blue-600 rounded focus:ring-blue-500">
                            <label for="inputTerms" class="text-xs text-blue-800">
                                Acepto los <strong>Términos de Servicio</strong> y autorizo el procesamiento de mis datos para la creación automática de mi infraestructura digital.
                            </label>
                        </div>
                    </div>
                </div>

                <div *ngSwitchCase="4" class="step-content active">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fa-solid fa-check text-green-600 text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-slate-800">¡Todo listo para despegar!</h2>
                        <p class="text-slate-500">Revisa tu configuración antes de continuar.</p>
                    </div>

                    <div class="bg-slate-50 p-6 rounded-xl border border-slate-200 space-y-4 mb-6">
    <div class="flex justify-between items-end border-b border-slate-200 pb-4">
        <div>
            <span class="font-bold text-slate-700 text-lg">Resumen de Inversión</span>
            <p class="text-xs text-slate-500">Cliente: {{ client.name }}</p>
        </div>
    </div>

    <div class="space-y-2">
        <div class="flex justify-between text-sm">
            <span class="text-slate-600">Industria Base ({{ configService.industry() }})</span>
            <span class="font-medium text-slate-800">${{ configService.basePrice() | number }}</span>
        </div>
        <div class="flex justify-between text-sm" *ngFor="let mod of configService.selectedModules()">
            <span class="text-slate-500">+ {{ mod.name }}</span>
            <span class="font-medium text-slate-800">${{ mod.price | number }}</span>
        </div>
        
        <div class="flex justify-between items-center pt-2 mt-2 border-t border-slate-200 border-dashed">
            <div class="flex flex-col">
                <span class="font-bold text-slate-800">Pago Único (Hoy)</span>
                <span class="text-[10px] text-green-600 font-medium">Implementación e Infraestructura</span>
            </div>
            <span class="font-bold text-2xl text-slate-900">${{ totalDisplay() | number: '1.0-0' }}</span>
        </div>
    </div>

    <div class="mt-4 pt-4 border-t-2 border-white bg-blue-50/50 -mx-6 px-6 pb-2">
        <div class="flex justify-between items-center">
            <div class="flex flex-col">
                <span class="font-bold text-blue-800">Suscripción Mensual</span>
                <span class="text-xs text-blue-600 flex items-center gap-1">
                    <i class="fa-solid fa-gift"></i> ¡Primeros 30 días GRATIS!
                </span>
            </div>
            <div class="text-right">
                <span class="font-bold text-xl text-blue-700">${{ monthlyPrice | number }}<span class="text-sm font-normal">/mes</span></span>
                <p class="text-[10px] text-blue-400">Inicia el {{ getNextMonthDate() | date:'dd/MM/yyyy' }}</p>
            </div>
        </div>
    </div>
</div>
                    
                    <div id="highValueAlert" [class.hidden]="totalDisplay() <= 5000"
                        class="mb-6 bg-amber-50 border border-amber-200 rounded-lg p-4 text-amber-800 text-sm flex gap-3 items-start">
                        <i class="fa-solid fa-crown mt-1"></i>
                        <div>
                            <strong>Configuración Enterprise detectada.</strong>
                            <p>Debido a la complejidad de tu sistema (> $5,000), requerimos una validación técnica rápida.</p>
                        </div>
                    </div>

                    <button (click)="submitFinalOrder()" [disabled]="isSubmitting" id="btnSubmit" 
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg transition-all transform active:scale-95 flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                        <span>Procesar Solicitud</span>
                        <i class="fa-solid fa-rocket"></i>
                    </button>
                </div>
            </ng-container>
        </div>

        <div class="bg-slate-50 px-8 py-4 border-t border-slate-200 flex justify-between">
            <button (click)="prevStep()" id="btnPrev" 
                [class.invisible]="currentStep === 1"
                class="px-6 py-2 rounded-lg text-slate-500 hover:text-slate-800 hover:bg-slate-200 font-medium transition-colors">
                Atrás
            </button>
            <button (click)="nextStep()" id="btnNext" 
                [class.hidden]="currentStep === 4"
                class="px-6 py-2 rounded-lg bg-slate-800 text-white hover:bg-slate-900 font-medium transition-colors shadow-md">
                Continuar
            </button>
        </div>
    </div>
</main>